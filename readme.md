# ðŸš€[LEVEL2 P_stage ìž¬í™œìš© ì“°ë ˆê¸° ë¶„ë¥˜ ëŒ€íšŒ] ì–¸ì œì˜¤ë¥´ì¡°
![image](https://user-images.githubusercontent.com/59071505/168442125-cf9bac11-f27d-48ac-a2a3-84c97050b923.png)

&nbsp; 
## ðŸ”¥ Member ðŸ”¥
<table>
  <tr height="125px">
    <td align="center" width="120px">
      <a href="https://github.com/kimkihoon0515"><img src="https://avatars.githubusercontent.com/kimkihoon0515"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ed-kyu"><img src="https://avatars.githubusercontent.com/ed-kyu"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/GwonPyo"><img src="https://avatars.githubusercontent.com/GwonPyo"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ysw2946"><img src="https://avatars.githubusercontent.com/ysw2946"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/jsh0551"><img src="https://avatars.githubusercontent.com/jsh0551"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/YJ0522771"><img src="https://avatars.githubusercontent.com/YJ0522771"/></a>
    </td>

  </tr>
  <tr height="70px">
    <td align="center" width="120px">
      <a href="https://github.com/kimkihoon0515">ê¹€ê¸°í›ˆ_T3019</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ed-kyu">ê¹€ìŠ¹ê·œ_T3037</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/GwonPyo">ë‚¨ê¶Œí‘œ_T3072</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ysw2946">ìœ ìŠ¹ìš°_T3130</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/jsh0551">ìž¥ìˆ˜í˜¸_T3185</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/YJ0522771">ì¡°ìœ ì§„_T3208</a>
    </td>
  </tr>
</table>

&nbsp; 
## ðŸ”Project Overview
ë°”ì•¼íë¡œ ëŒ€ëŸ‰ ìƒì‚°, ëŒ€ëŸ‰ ì†Œë¹„ì˜ ì‹œëŒ€. ìš°ë¦¬ëŠ” ë§Žì€ ë¬¼ê±´ì´ ëŒ€ëŸ‰ìœ¼ë¡œ ìƒì‚°ë˜ê³ , ì†Œë¹„ë˜ëŠ” ì‹œëŒ€ë¥¼ ì‚´ê³  ìžˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ ë¬¸í™”ëŠ” 'ì“°ë ˆê¸° ëŒ€ëž€', 'ë§¤ë¦½ì§€ ë¶€ì¡±'ê³¼ ê°™ì€ ì—¬ëŸ¬ ì‚¬íšŒ ë¬¸ì œë¥¼ ë‚³ê³  ìžˆìŠµë‹ˆë‹¤.

ë¶„ë¦¬ìˆ˜ê±°ëŠ” ì´ëŸ¬í•œ í™˜ê²½ ë¶€ë‹´ì„ ì¤„ì¼ ìˆ˜ ìžˆëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ìž…ë‹ˆë‹¤. ìž˜ ë¶„ë¦¬ë°°ì¶œ ëœ ì“°ë ˆê¸°ëŠ” ìžì›ìœ¼ë¡œì„œ ê°€ì¹˜ë¥¼ ì¸ì •ë°›ì•„ ìž¬í™œìš©ë˜ì§€ë§Œ, ìž˜ëª» ë¶„ë¦¬ë°°ì¶œ ë˜ë©´ ê·¸ëŒ€ë¡œ íê¸°ë¬¼ë¡œ ë¶„ë¥˜ë˜ì–´ ë§¤ë¦½ ë˜ëŠ” ì†Œê°ë˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì‚¬ì§„ì—ì„œ ì“°ë ˆê¸°ë¥¼ Detection í•˜ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì–´ ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•´ë³´ê³ ìž í•©ë‹ˆë‹¤.

- Input : ì“°ë ˆê¸° ê°ì²´ê°€ ë‹´ê¸´ ì´ë¯¸ì§€ì™€ bbox ì •ë³´(ì¢Œí‘œ, ì¹´í…Œê³ ë¦¬,COCO format) 
  
- Output : ëª¨ë¸ì€ bbox ì¢Œí‘œ, ì¹´í…Œê³ ë¦¬, score ê°’ì„ ë¦¬í„´í•˜ì—¬ csv í˜•ì‹ìœ¼ë¡œ ì œì¶œ

&nbsp; 
## ðŸ—‚ï¸Dataset
- Train Images : 4883 images
- Test Images : 4871 images
- Class Names : General trash, Paper, Paper pack, Metal, Glass, Plastic, Styrofoam, Plastic bag, Battery, Clothing
- Image Size : 1024x1024

&nbsp;

## ðŸ§±Structure
â”œâ”€â”€ baseline  
â”‚Â Â  â”œâ”€â”€ detectron2  
â”‚Â Â  â”œâ”€â”€ faster_rcnn  
â”‚Â Â  â”œâ”€â”€ mmdetection  
â”‚Â Â  â”œâ”€â”€ yolov5  
â”‚Â Â  â””â”€â”€ requirements.txt  
â”œâ”€â”€ dataset  
â”‚Â Â  â”œâ”€â”€ test  
â”‚Â Â  â”œâ”€â”€ test.json  
â”‚Â Â  â”œâ”€â”€ train  
â”‚Â Â  â””â”€â”€ train.json  
â”œâ”€â”€ mission  
â”‚Â Â  â””â”€â”€ ...  
â””â”€â”€ sample_submission  
    â”œâ”€â”€ faster_rcnn_mmdetection_submission.csv  
    â”œâ”€â”€ faster_rcnn_torchvision_submission.csv  
    â”œâ”€â”€ submission_ensemble.csv  
    â””â”€â”€ train_sample.csv  


&nbsp;

## ðŸ§ªExperiments

|  | Model | Backbone | Public_mAP | Private_mAP |
| --- | --- | --- | --- | --- |
| 2 Stage | Cascade rcnn | Swin_t | 0.6031 | 0.5858 |
|  | Cascade rcnn | Swin_b | 0.6192 | 0.6066 |
|  | Cascade rcnn | Swin_L | 0.6161 | 0.5964 |
|  | ATSS | Swin_t | 0.5114 | 0.4896 |
| 1Stage | Yolov5x  |  | 0.5652 | 0.5511 |
|  | Yolov5x6  |  | 0.5587 | 0.5329 |
|  | EfficientDet_D5  | EfficientNet | 0.5161 | 0.5077 |
| Ensemble | Cascade + Yolo + EfficienDet |  | 0.6912 | 0.6759 |


&nbsp;

## ðŸ†Result
- ì´ 19 íŒ€ ì°¸ì—¬
- Public : 14ë“± -> Private : 14ë“±
- Public : 0.6912 -> Private : 0.6759
  
![image](https://user-images.githubusercontent.com/59071505/168442374-caeaee8b-39ce-4121-9297-67dad50db8a0.png)

&nbsp;

## ðŸ’¡Usage

### Install Requirements
```
pip install -r requirements.txt
```  
### Model Information

[YOLOv5](yolov5)
```
optimizer : SGD
scheduler : lambdaLR
epoch : 70
loss : BCEWithLogitLoss
```

[Swin-L FPN Cascade R-CNN](Mmdetection/Swin_L)
```
optimizedr : AdamW
scheduler : stepLR
epoch : 12
loss : classification : CSE
       bbox : Smooth L1
```

### Ensemble
```
YOLOv5x6(multi-scale+pseudo labeling+TTA+augmentations) + swinL(multi-scale,TTA) + EfficiendDet(offline data,TTA,augmentations)
```

